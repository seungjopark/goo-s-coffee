<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>구스커피 주문 관리 시스템</title>
    
    <!-- PWA 설정 -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#8B4513">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="구스커피">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM4QjQ1MTMiLz4KPHBhdGggZD0iTTk2IDQ4Qzc3LjIgNDggNjIgNjMuMiA2MiA4MkM2MiAxMDAuOCA3Ny4yIDExNiA5NiAxMTZDMTE0LjggMTE2IDEzMCAxMDAuOCAxMzAgODJDMTMwIDYzLjIgMTE0LjggNDggOTYgNDhaIiBmaWxsPSIjRkZFNEI1Ii8+CjxwYXRoIGQ9Ik03MiA5NkM3MiA5NiA4NCA4NCA5NiA4NEMxMDggODQgMTIwIDk2IDEyMCA5NkgxNDBWMTMySDUyVjk2SDcyWiIgZmlsbD0iI0QyQjQ4QyIvPgo8cGF0aCBkPSJNNTIgMTMySDU2VjE0NEg1MlYxMzJaTTEzNiAxMzJIMTQwVjE0NEgxMzZWMTMyWiIgZmlsbD0iIzM0M0EzOCIvPgo8L3N2Zz4K">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-coffee"></i>
                <h1>구스커피 주문관리</h1>
            </div>
            <div class="date-display">
                <i class="fas fa-calendar"></i>
                <span id="current-date"></span>
            </div>
        </div>
    </header>

    <!-- 네비게이션 탭 -->
    <nav class="nav-tabs">
        <div class="container">
            <button class="tab-btn active" data-tab="order">
                <i class="fas fa-plus-circle"></i>
                <span>주문등록</span>
            </button>
            <button class="tab-btn" data-tab="products">
                <i class="fas fa-coffee"></i>
                <span>상품관리</span>
            </button>
            <button class="tab-btn" data-tab="history">
                <i class="fas fa-list"></i>
                <span>주문내역</span>
            </button>
            <button class="tab-btn" data-tab="statistics">
                <i class="fas fa-chart-bar"></i>
                <span>통계</span>
            </button>
        </div>
    </nav>

    <!-- 메인 컨텐츠 -->
    <main class="main-content">
        <div class="container">
            
            <!-- 주문 등록 탭 -->
            <div id="order-tab" class="tab-content active">
                <div class="section-header">
                    <h2><i class="fas fa-plus-circle"></i> 새 주문 등록</h2>
                    <div class="today-summary">
                        <span>오늘 주문: <strong id="today-orders">0건</strong></span>
                        <span>오늘 매출: <strong id="today-revenue">0원</strong></span>
                    </div>
                </div>

                <div class="order-form">
                    <div class="order-products-grid" id="order-products-grid">
                        <!-- 상품 타일들이 여기에 표시됩니다 -->
                    </div>

                    <div class="order-total">
                        <div class="order-summary">
                            <h3><i class="fas fa-receipt"></i> 주문 요약</h3>
                            <div class="order-summary-items" id="order-summary-items">
                                <!-- 주문된 상품들 요약이 여기에 표시됩니다 -->
                            </div>
                        </div>
                        <div class="total-display">
                            <span>총 주문 금액</span>
                            <span class="total-amount" id="total-amount">0원</span>
                        </div>
                        <div class="order-actions">
                            <button class="btn btn-secondary" onclick="clearOrder()">
                                <i class="fas fa-undo"></i> 수량 초기화
                            </button>
                            <button class="btn btn-primary" onclick="saveOrder()">
                                <i class="fas fa-save"></i> 주문 저장
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 상품 관리 탭 -->
            <div id="products-tab" class="tab-content">
                <div class="section-header">
                    <h2><i class="fas fa-coffee"></i> 상품 관리</h2>
                    <button class="btn btn-primary" onclick="showAddProductModal()">
                        <i class="fas fa-plus"></i> 새 상품 추가
                    </button>
                </div>

                <div class="products-grid" id="products-grid">
                    <!-- 상품 목록이 여기에 표시됩니다 -->
                </div>
            </div>

            <!-- 주문 내역 탭 -->
            <div id="history-tab" class="tab-content">
                <div class="section-header">
                    <h2><i class="fas fa-list"></i> 주문 내역</h2>
                    <div class="date-filter">
                        <div class="filter-section">
                            <h4><i class="fas fa-calendar-alt"></i> 날짜 필터</h4>
                            <div class="date-inputs">
                                <div class="date-input-group">
                                    <label for="start-date">시작날짜</label>
                                    <input type="date" id="start-date" onchange="filterOrderByRange()">
                                </div>
                                <div class="date-range-separator">~</div>
                                <div class="date-input-group">
                                    <label for="end-date">종료날짜</label>
                                    <input type="date" id="end-date" onchange="filterOrderByRange()">
                                </div>
                            </div>
                        </div>
                        
                        <div class="filter-buttons">
                            <button class="btn btn-primary" onclick="setTodayFilter()">
                                <i class="fas fa-calendar-day"></i> 오늘
                            </button>
                            <button class="btn btn-secondary" onclick="setWeekFilter()">
                                <i class="fas fa-calendar-week"></i> 이번주
                            </button>
                            <button class="btn btn-secondary" onclick="setMonthFilter()">
                                <i class="fas fa-calendar"></i> 이번달
                            </button>
                            <button class="btn btn-secondary" onclick="clearDateFilter()">
                                <i class="fas fa-list"></i> 전체 보기
                            </button>
                        </div>
                        
                        <div class="filter-status" id="filter-status">
                            <!-- 현재 필터 상태가 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>

                <div class="orders-list" id="orders-list">
                    <!-- 주문 내역이 여기에 표시됩니다 -->
                </div>
            </div>

            <!-- 통계 탭 -->
            <div id="statistics-tab" class="tab-content">
                <div class="section-header">
                    <h2><i class="fas fa-chart-bar"></i> 매출 통계</h2>
                    <div class="period-selector">
                        <button class="btn btn-secondary period-btn active" data-period="daily">일별</button>
                        <button class="btn btn-secondary period-btn" data-period="monthly">월별</button>
                        <button class="btn btn-secondary period-btn" data-period="yearly">연별</button>
                    </div>
                </div>

                <div class="statistics-content">
                    <div class="stats-summary">
                        <div class="stat-card">
                            <div class="stat-value" id="total-revenue">0원</div>
                            <div class="stat-label">총 매출</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-orders">0건</div>
                            <div class="stat-label">총 주문</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-order-amount">0원</div>
                            <div class="stat-label">평균 주문액</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="sales-chart" width="400" height="200"></canvas>
                    </div>

                    <div class="product-ranking">
                        <h3>상품별 판매 순위</h3>
                        <div class="ranking-list" id="ranking-list">
                            <!-- 상품 순위가 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 상품 추가/수정 모달 -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">새 상품 추가</h3>
                <button class="modal-close" onclick="closeProductModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="product-form" onsubmit="saveProduct(event)">
                    <input type="hidden" id="product-id">
                    <div class="form-group">
                        <label for="product-name">상품명</label>
                        <input type="text" id="product-name" required placeholder="예: 에티오피아 예가체프">
                    </div>
                    <div class="form-group">
                        <label for="product-price">가격 (원)</label>
                        <input type="number" id="product-price" required placeholder="15000" min="0">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeProductModal()">취소</button>
                        <button type="submit" class="btn btn-primary">저장</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 로딩 스피너 -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
    </div>

    <!-- 알림 메시지 -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <i class="notification-icon"></i>
            <span class="notification-message"></span>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="db.js"></script>
    <script src="script.js"></script>
    
    <!-- PWA Service Worker 등록 -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>

